[{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Bạn có thể bổ sung vào phần blog như sau:\nIncrease Uploadable Plugin Size By default, WordPress relies on PHP configuration (upload_max_filesize, post_max_size, and sometimes max_execution_time) to determine the maximum file size that can be uploaded. On many servers, this limit is set as low as 2MB – 8MB, which is not enough for modern plugins.\nWhy Increase the Limit? Large plugins: Some plugins such as WooCommerce extensions, page builders, backup tools, or security suites can easily reach 20MB – 100MB.\nAvoid errors: If the plugin .zip file exceeds the limit, you’ll see errors like:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Or the upload process fails silently. Ease of use: Increasing the limit allows administrators to upload plugins directly from the WordPress Dashboard without needing FTP/SSH access.\nDevelopment and testing: Developers testing their own plugins (with bundled assets like JS, CSS, images, or libraries) may generate larger .zip files. A higher limit makes local testing smoother.\nHow to Increase Plugin Upload Size There are several methods depending on your hosting environment:\nEdit php.ini (if you control the server)\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Edit .htaccess (for Apache servers)\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Update wp-config.php Add before the line /* That's all, stop editing! Happy publishing. */:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Check with your hosting provider Some shared hosting environments don’t allow direct changes to PHP settings. In this case, you’ll need to request support to increase the upload limit.\n👉 It’s recommended to set a reasonable value (e.g., 64MB or 128MB). Avoid setting it too high (hundreds of MBs), as it may open the door to abuse (e.g., users uploading excessively large files that overload the server).\nBạn có muốn mình viết lại cả mục \u0026ldquo;Extend\u0026rdquo; (Required Version, Auto Update, và Increase Uploadable Plugin Size) thành một đoạn mượt mà, đúng phong cách blog tiếng Anh, thay vì dịch từng phần rời rạc không?\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Bạn có thể bổ sung vào phần blog như sau:\nIncrease Uploadable Plugin Size By default, WordPress relies on PHP configuration (upload_max_filesize, post_max_size, and sometimes max_execution_time) to determine the maximum file size that can be uploaded. On many servers, this limit is set as low as 2MB – 8MB, which is not enough for modern plugins.\nWhy Increase the Limit? Large plugins: Some plugins such as WooCommerce extensions, page builders, backup tools, or security suites can easily reach 20MB – 100MB.\nAvoid errors: If the plugin .zip file exceeds the limit, you’ll see errors like:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Or the upload process fails silently. Ease of use: Increasing the limit allows administrators to upload plugins directly from the WordPress Dashboard without needing FTP/SSH access.\nDevelopment and testing: Developers testing their own plugins (with bundled assets like JS, CSS, images, or libraries) may generate larger .zip files. A higher limit makes local testing smoother.\nHow to Increase Plugin Upload Size There are several methods depending on your hosting environment:\nEdit php.ini (if you control the server)\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Edit .htaccess (for Apache servers)\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Update wp-config.php Add before the line /* That's all, stop editing! Happy publishing. */:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Check with your hosting provider Some shared hosting environments don’t allow direct changes to PHP settings. In this case, you’ll need to request support to increase the upload limit.\n👉 It’s recommended to set a reasonable value (e.g., 64MB or 128MB). Avoid setting it too high (hundreds of MBs), as it may open the door to abuse (e.g., users uploading excessively large files that overload the server).\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Bạn có thể bổ sung vào phần blog như sau:\nIncrease Uploadable Plugin Size By default, WordPress relies on PHP configuration (upload_max_filesize, post_max_size, and sometimes max_execution_time) to determine the maximum file size that can be uploaded. On many servers, this limit is set as low as 2MB – 8MB, which is not enough for modern plugins.\nWhy Increase the Limit? Large plugins: Some plugins such as WooCommerce extensions, page builders, backup tools, or security suites can easily reach 20MB – 100MB.\nAvoid errors: If the plugin .zip file exceeds the limit, you’ll see errors like:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Or the upload process fails silently. Ease of use: Increasing the limit allows administrators to upload plugins directly from the WordPress Dashboard without needing FTP/SSH access.\nDevelopment and testing: Developers testing their own plugins (with bundled assets like JS, CSS, images, or libraries) may generate larger .zip files. A higher limit makes local testing smoother.\nHow to Increase Plugin Upload Size There are several methods depending on your hosting environment:\nEdit php.ini (if you control the server)\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Edit .htaccess (for Apache servers)\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Update wp-config.php Add before the line /* That's all, stop editing! Happy publishing. */:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Check with your hosting provider Some shared hosting environments don’t allow direct changes to PHP settings. In this case, you’ll need to request support to increase the upload limit.\n👉 It’s recommended to set a reasonable value (e.g., 64MB or 128MB). Avoid setting it too high (hundreds of MBs), as it may open the door to abuse (e.g., users uploading excessively large files that overload the server).\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Bạn có thể bổ sung vào phần blog như sau:\nIncrease Uploadable Plugin Size Ok, mình sẽ viết lại toàn bộ phần Extend thành cả hai ngôn ngữ: tiếng Việt và tiếng Anh để bạn có thể đưa vào blog.\nBản tiếng Việt Mở Rộng (Extend) Phiên bản yêu cầu (Required Version) Mỗi phiên bản WordPress thường đi kèm với một phiên bản PHP phù hợp. Nếu dùng PHP quá cũ hoặc quá mới so với phiên bản WordPress, bạn có thể gặp lỗi trong quá trình cài đặt hoặc vận hành. Vì vậy, trước khi setup, hãy kiểm tra bảng tương thích PHP và WordPress để tránh rắc rối.\nCập nhật tự động (WordPress Auto Update) Từ WordPress 3.7 (2013), hệ thống đã hỗ trợ cơ chế cập nhật tự động nền (automatic background updates) cho:\nCác bản vá bảo mật (security release). Các bản bảo trì (maintenance release). Không tự động cập nhật phiên bản lớn (major version), trừ khi bạn bật thủ công. WordPress sẽ kết nối tới api.wordpress.org để kiểm tra bản vá mới và tự động nâng cấp. Quá trình này diễn ra rất nhanh sau khi setup, nên đôi khi bạn sẽ thấy mã nguồn thay đổi khác so với bản tải từ wordpress.org.\nCơ chế cập nhật này được kích hoạt khi bạn truy cập /wp-admin/install.php. Nếu muốn vô hiệu hóa, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Tăng dung lượng plugin có thể upload (Increase Uploadable Plugin Size) Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nVì sao cần tăng giới hạn? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nCách tăng giới hạn upload plugin Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Liên hệ nhà cung cấp hosting: Nếu bạn dùng shared hosting, đôi khi không thể chỉnh trực tiếp, cần nhờ support tăng giới hạn.\n👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\nEnglish Version Extend Required Version Each WordPress release comes with a recommended PHP version. Using a PHP version that is too old or too new compared to the WordPress release may cause errors during setup or runtime. Always check the PHP–WordPress compatibility chart before installation.\nWordPress Auto Update Since WordPress 3.7 (2013), the platform supports automatic background updates for:\nSecurity releases. Maintenance releases. Not for major versions, unless explicitly enabled. WordPress connects to api.wordpress.org to check for new patches and updates automatically. This process happens shortly after setup, so you may notice code differences compared to the package you downloaded from wordpress.org.\nThe update process is triggered when accessing /wp-admin/install.php. To disable auto-updates, add this line to wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size By default, WordPress depends on PHP configuration (upload_max_filesize, post_max_size, and sometimes max_execution_time) to determine the maximum upload size. On many hosting servers, the default limit is only 2MB – 8MB, which is insufficient for modern plugins.\nWhy increase the limit? Large plugins: WooCommerce extensions, page builders, backup, or security plugins can be 20MB – 100MB.\nAvoid upload errors: Exceeding the limit causes errors like:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Or silent upload failures. Convenience for admins: Install plugins directly from the Dashboard without needing FTP/SSH.\nPlugin development: Custom plugins with bundled assets (JS, CSS, libraries) may generate large .zip files. A higher limit makes testing easier.\nHow to increase plugin upload size Edit php.ini (server-level):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Edit .htaccess (Apache servers):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Update wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Contact hosting provider: On shared hosting, PHP limits may not be editable directly. Request support to increase the limit.\n👉 Tip: Set a reasonable value (64MB–128MB). Avoid excessively high limits to reduce risks like server overload from heavy file uploads.\nBạn có muốn mình gộp song ngữ (Việt–Anh) vào một file blog duy nhất (như dạng “song song” để người đọc chọn ngôn ngữ), hay tách riêng thành 2 bản?\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Bạn có thể bổ sung vào phần blog như sau:\nIncrease Uploadable Plugin Size Ok, mình sẽ viết lại toàn bộ phần Extend thành cả hai ngôn ngữ: tiếng Việt và tiếng Anh để bạn có thể đưa vào blog.\nBản tiếng Việt Mở Rộng (Extend) Phiên bản yêu cầu (Required Version) Mỗi phiên bản WordPress thường đi kèm với một phiên bản PHP phù hợp. Nếu dùng PHP quá cũ hoặc quá mới so với phiên bản WordPress, bạn có thể gặp lỗi trong quá trình cài đặt hoặc vận hành. Vì vậy, trước khi setup, hãy kiểm tra bảng tương thích PHP và WordPress để tránh rắc rối.\nCập nhật tự động (WordPress Auto Update) Từ WordPress 3.7 (2013), hệ thống đã hỗ trợ cơ chế cập nhật tự động nền (automatic background updates) cho:\nCác bản vá bảo mật (security release). Các bản bảo trì (maintenance release). Không tự động cập nhật phiên bản lớn (major version), trừ khi bạn bật thủ công. WordPress sẽ kết nối tới api.wordpress.org để kiểm tra bản vá mới và tự động nâng cấp. Quá trình này diễn ra rất nhanh sau khi setup, nên đôi khi bạn sẽ thấy mã nguồn thay đổi khác so với bản tải từ wordpress.org.\nCơ chế cập nhật này được kích hoạt khi bạn truy cập /wp-admin/install.php. Nếu muốn vô hiệu hóa, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Tăng dung lượng plugin có thể upload (Increase Uploadable Plugin Size) Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nVì sao cần tăng giới hạn? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nCách tăng giới hạn upload plugin Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Liên hệ nhà cung cấp hosting: Nếu bạn dùng shared hosting, đôi khi không thể chỉnh trực tiếp, cần nhờ support tăng giới hạn.\n👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\nEnglish Version Extend Required Version Each WordPress release comes with a recommended PHP version. Using a PHP version that is too old or too new compared to the WordPress release may cause errors during setup or runtime. Always check the PHP–WordPress compatibility chart before installation.\nWordPress Auto Update Since WordPress 3.7 (2013), the platform supports automatic background updates for:\nSecurity releases. Maintenance releases. Not for major versions, unless explicitly enabled. WordPress connects to api.wordpress.org to check for new patches and updates automatically. This process happens shortly after setup, so you may notice code differences compared to the package you downloaded from wordpress.org.\nThe update process is triggered when accessing /wp-admin/install.php. To disable auto-updates, add this line to wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size By default, WordPress depends on PHP configuration (upload_max_filesize, post_max_size, and sometimes max_execution_time) to determine the maximum upload size. On many hosting servers, the default limit is only 2MB – 8MB, which is insufficient for modern plugins.\nWhy increase the limit? Large plugins: WooCommerce extensions, page builders, backup, or security plugins can be 20MB – 100MB.\nAvoid upload errors: Exceeding the limit causes errors like:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Or silent upload failures. Convenience for admins: Install plugins directly from the Dashboard without needing FTP/SSH.\nPlugin development: Custom plugins with bundled assets (JS, CSS, libraries) may generate large .zip files. A higher limit makes testing easier.\nHow to increase plugin upload size Edit php.ini (server-level):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Edit .htaccess (Apache servers):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Update wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Contact hosting provider: On shared hosting, PHP limits may not be editable directly. Request support to increase the limit.\n👉 Tip: Set a reasonable value (64MB–128MB). Avoid excessively high limits to reduce risks like server overload from heavy file uploads.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nWhy Increase the Limit? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nCách tăng giới hạn upload plugin Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Liên hệ nhà cung cấp hosting: Nếu bạn dùng shared hosting, đôi khi không thể chỉnh trực tiếp, cần nhờ support tăng giới hạn.\n👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\nEnglish Version Extend Required Version Each WordPress release comes with a recommended PHP version. Using a PHP version that is too old or too new compared to the WordPress release may cause errors during setup or runtime. Always check the PHP–WordPress compatibility chart before installation.\nWordPress Auto Update Since WordPress 3.7 (2013), the platform supports automatic background updates for:\nSecurity releases. Maintenance releases. Not for major versions, unless explicitly enabled. WordPress connects to api.wordpress.org to check for new patches and updates automatically. This process happens shortly after setup, so you may notice code differences compared to the package you downloaded from wordpress.org.\nThe update process is triggered when accessing /wp-admin/install.php. To disable auto-updates, add this line to wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size By default, WordPress depends on PHP configuration (upload_max_filesize, post_max_size, and sometimes max_execution_time) to determine the maximum upload size. On many hosting servers, the default limit is only 2MB – 8MB, which is insufficient for modern plugins.\nWhy increase the limit? Large plugins: WooCommerce extensions, page builders, backup, or security plugins can be 20MB – 100MB.\nAvoid upload errors: Exceeding the limit causes errors like:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Or silent upload failures. Convenience for admins: Install plugins directly from the Dashboard without needing FTP/SSH.\nPlugin development: Custom plugins with bundled assets (JS, CSS, libraries) may generate large .zip files. A higher limit makes testing easier.\nHow to increase plugin upload size Edit php.ini (server-level):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Edit .htaccess (Apache servers):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Update wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Contact hosting provider: On shared hosting, PHP limits may not be editable directly. Request support to increase the limit.\n👉 Tip: Set a reasonable value (64MB–128MB). Avoid excessively high limits to reduce risks like server overload from heavy file uploads.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nWhy Increase the Limit? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nHow to Increase Plugin Upload Size Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Liên hệ nhà cung cấp hosting: Nếu bạn dùng shared hosting, đôi khi không thể chỉnh trực tiếp, cần nhờ support tăng giới hạn.\n👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\nEnglish Version Extend Required Version Each WordPress release comes with a recommended PHP version. Using a PHP version that is too old or too new compared to the WordPress release may cause errors during setup or runtime. Always check the PHP–WordPress compatibility chart before installation.\nWordPress Auto Update Since WordPress 3.7 (2013), the platform supports automatic background updates for:\nSecurity releases. Maintenance releases. Not for major versions, unless explicitly enabled. WordPress connects to api.wordpress.org to check for new patches and updates automatically. This process happens shortly after setup, so you may notice code differences compared to the package you downloaded from wordpress.org.\nThe update process is triggered when accessing /wp-admin/install.php. To disable auto-updates, add this line to wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size By default, WordPress depends on PHP configuration (upload_max_filesize, post_max_size, and sometimes max_execution_time) to determine the maximum upload size. On many hosting servers, the default limit is only 2MB – 8MB, which is insufficient for modern plugins.\nWhy increase the limit? Large plugins: WooCommerce extensions, page builders, backup, or security plugins can be 20MB – 100MB.\nAvoid upload errors: Exceeding the limit causes errors like:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Or silent upload failures. Convenience for admins: Install plugins directly from the Dashboard without needing FTP/SSH.\nPlugin development: Custom plugins with bundled assets (JS, CSS, libraries) may generate large .zip files. A higher limit makes testing easier.\nHow to increase plugin upload size Edit php.ini (server-level):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Edit .htaccess (Apache servers):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Update wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Contact hosting provider: On shared hosting, PHP limits may not be editable directly. Request support to increase the limit.\n👉 Tip: Set a reasonable value (64MB–128MB). Avoid excessively high limits to reduce risks like server overload from heavy file uploads.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nWhy Increase the Limit? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nHow to Increase Plugin Upload Size Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); 👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\nEnglish Version Extend Required Version Each WordPress release comes with a recommended PHP version. Using a PHP version that is too old or too new compared to the WordPress release may cause errors during setup or runtime. Always check the PHP–WordPress compatibility chart before installation.\nWordPress Auto Update Since WordPress 3.7 (2013), the platform supports automatic background updates for:\nSecurity releases. Maintenance releases. Not for major versions, unless explicitly enabled. WordPress connects to api.wordpress.org to check for new patches and updates automatically. This process happens shortly after setup, so you may notice code differences compared to the package you downloaded from wordpress.org.\nThe update process is triggered when accessing /wp-admin/install.php. To disable auto-updates, add this line to wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size By default, WordPress depends on PHP configuration (upload_max_filesize, post_max_size, and sometimes max_execution_time) to determine the maximum upload size. On many hosting servers, the default limit is only 2MB – 8MB, which is insufficient for modern plugins.\nWhy increase the limit? Large plugins: WooCommerce extensions, page builders, backup, or security plugins can be 20MB – 100MB.\nAvoid upload errors: Exceeding the limit causes errors like:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Or silent upload failures. Convenience for admins: Install plugins directly from the Dashboard without needing FTP/SSH.\nPlugin development: Custom plugins with bundled assets (JS, CSS, libraries) may generate large .zip files. A higher limit makes testing easier.\nHow to increase plugin upload size Edit php.ini (server-level):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Edit .htaccess (Apache servers):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Update wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); Contact hosting provider: On shared hosting, PHP limits may not be editable directly. Request support to increase the limit.\n👉 Tip: Set a reasonable value (64MB–128MB). Avoid excessively high limits to reduce risks like server overload from heavy file uploads.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nWhy Increase the Limit? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nHow to Increase Plugin Upload Size Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); 👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nWhy Increase the Limit? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nHow to Increase Plugin Upload Size Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); 👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. {: .prompt-info } Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nWhy Increase the Limit? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nHow to Increase Plugin Upload Size Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); 👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nWhy Increase the Limit? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nHow to Increase Plugin Upload Size Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); 👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"WordPress là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\nRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page… Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress. Có 2 phiên bản WordPress:\nWordPress.com Dịch vụ hosting do Automattic cung cấp Bạn chỉ cần đăng ký tài khoản, không phải cài đặt Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí WordPress.org Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình Ecosystem Core: CMS chính Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiện tại hơn 40% website trên toàn thế giới chạy WordPress Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =\u0026gt; có thể khai thác hàng triệu site cùng lúc Giống như “cá nhiều thì chài ở đó” Plugin and Theme WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn developers và researchers. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác Setup WordPress for Hacking Có rất nhiều cách để setup WorkPress, tìm kiếm bằng Google có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo Ubuntu (22.04):\nKhông ảnh hưởng đến các dịch vụ của máy thật WordPress tương đối nhẹ để sử dụng trên máy ảo Install and configure WordPress Install Dependencies Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Tải và cài mã nguồn WordPress vào thư mục web.\n# Tạo folder để lưu trữ mã nguồn website sudo mkdir -p /srv/www # Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server # Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data. sudo chown www-data: /srv/www # Tải gói WordPress mới nhất từ trang chính thức # Giải nén vao thưc mục /srv/www được tạo ở trên curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www Có thể tải phiên bản cụ thể bằng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www Cài từ wordpress.org là cách chuẩn nhất và ít rủi ro:\nUbuntu có sẵn package wordpress trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên wordpress.org Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ wordpress.org, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được. Configure Apache for WordPress Tạo file /etc/apache2/sites-available/wordpress.conf cấu hình Apache cho WordPress:\n# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Thư mục gốc của website (nơi chứa mã nguồn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị. DirectoryIndex index.php # Cho phép tất cả mọi người truy cập (cần cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; Kích hoạt site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (tạo symlink từ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau đó site wordpress sẽ được Apache load khi restart. Kích hoạt module rewrite:\nsudo a2enmod rewrite WordPress cần module mod_rewrite để hỗ trợ Pretty Permalinks (ví dụ /blog/hello-world/ thay vì ?p=123) Vô hiệu hóa site mặc định (Option):\nsudo a2dissite 000-default Apache mặc định có site 000-default.conf (chỉ hiển thị \u0026ldquo;It works!\u0026rdquo;) Nếu không disable, site mặc định có thể chiếm port 80 trước WordPress 👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Tải lại cấu hình mới mà không cần dừng server Configure database WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:\nBài viết, trang, menu Người dùng, mật khẩu (hash) Cấu hình site Plugins, themes settings Mở MySQL với quyền root:\nsudo mysql -u root Cấu hình MySQL:\n-- Tạo database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Tạo user riêng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cấp quyền cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- Làm mới lại quyền mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Thoát mysql\u0026gt; quit Bye Khởi động lại dịch vụ:\nsudo service mysql start Configure WordPress to connect to the database Copy file cấu hình mẫu:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi tải về có sẵn file wp-config-sample.php Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site Chỉnh sửa thông tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php Đây là 3 dòng thay thế text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tên DB đã tạo ở bước trước) username_here =\u0026gt; wordpress (user MySQL đã tạo) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password đã set) Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL Thêm Secret Keys và Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php 👉 Đây là chuỗi bí mật mà WordPress dùng để:\nMã hóa session cookies Sinh ra token (nonce) chống CSRF Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay đổi nó bằng các chuỗi random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cập http://localhost, đặt site title, username, password, email cho user admin\nSetup Debug on VSCode Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.\nAdd PHP Debug extension on VS Code Vào Extensions (Ctrl+Shift+X) =\u0026gt; tìm PHP Debug (by Felix Becker) =\u0026gt; Install. Extension này kết nối với Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiểm tra cài chưa:\nphp -v Nếu có dòng with Xdebug v3.x.x nghĩa là đã OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Thêm vào cuối file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port mặc định mới của Xdebug v3 là 9003.\nSau đó restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Mở thư mục chứa trang web wordpress bằng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; tạo file launch.json với nội dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: ánh xạ thư mục trong container/server (/srv/www/wordpress) về thư mục local của trong VS Code.\nNhư vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.\nExtend Required Version Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.\nWordPress Auto Update Từ WordPress 3.7 trở đi (2013), WordPress có cơ chế tự động cập nhật (automatic background updates) cho:\nBản vá bảo mật (security release). Bản bảo trì (maintenance release). Không tự động update major version (trừ khi bật rõ ràng). Hệ thống kiểm tra với server api.wordpress.org để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.\nQuá trình setup diễn ra khi truy cập /wp-admin/install.php\nĐể vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Mặc định, WordPress phụ thuộc vào cấu hình PHP (upload_max_filesize, post_max_size, và đôi khi cả max_execution_time) để xác định dung lượng file tối đa có thể upload. Trên nhiều hosting, giới hạn này chỉ khoảng 2MB – 8MB, không đủ cho các plugin hiện đại.\nWhy Increase the Limit? Plugin dung lượng lớn: Các plugin như WooCommerce extension, page builder, backup, hoặc security suite có thể nặng 20MB – 100MB.\nTránh lỗi upload: Nếu file .zip lớn hơn giới hạn, bạn sẽ gặp lỗi:\n“The uploaded file exceeds the upload_max_filesize directive in php.ini” Hoặc upload thất bại. Thuận tiện cho quản trị viên: Có thể cài trực tiếp qua Dashboard mà không cần FTP/SSH.\nHỗ trợ phát triển plugin: Plugin tự viết kèm nhiều thư viện/asset có thể khá nặng, việc tăng giới hạn giúp test dễ dàng hơn.\nHow to Increase Plugin Upload Size Sửa php.ini (nếu có quyền server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sửa file .htaccess (nếu dùng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Thêm vào wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); 👉 Lời khuyên: Chỉ nên đặt giới hạn vừa đủ (64MB hoặc 128MB). Tránh đặt quá lớn để hạn chế nguy cơ bị upload file nặng gây quá tải server.\n","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…\u003c/li\u003e\n\u003cli\u003eHiện nay, hơn 40% website trên thế giới chạy bằng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCó 2 phiên bản WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"}]